# 后台接口说明

## 配置文件url的标记解释
- issplit 是否拆分消息体 0需要拆分 1不需要拆分，消息体整体转发出去
- isskip relay组织响应消息头 1-下游模块组织响应消息头 默认为0
- iszip 消息是否需要压缩 1不需要压缩
- isopen url开放方式 0－对外网开放 1－对内网开放 默认为0
- needtoken 0不需要 1需要
- needmobile 0不需要 1需要

## 对外接口说明

### 消息头说明

数据包消息头20字节：bStartFlag+bVer+bEncryptFlag+bFrag+shortwLen+shortwCmd+shortwSeq+wCrc+dwSID+wTotal+wCurSeq

### 消息头字段说明

| 序号 | 字段名称 | 类型 | 字段含义 | 说明 |
| --- | --- | --- | --- | --- |
| 1 | bStartFlag | unsigned char | 协议包起始标志 | 默认0xFF |
| 2 | bVer | char | 版本号 |  |
| 3 | bEncryptFlag | unsigned char | 压缩标志 | '0' 表示不压缩 '1'-gzip '2'-zlib |
| 4 | bFrag | unsigned char | 是否有包分片 | 1 有包分片 0 无包分片 |
| 5 | wLen | unsigned short | 总包长 |  |
| 6 | wCmd | unsigned short | 命令号 |  |
| 7 | wSeq | unsigned short | 包的序列号,业务使用 |  |
| 8 | wCrc | unsigned short | Crc16校验码 |  |
| 9 | dwSID | unsigned int | 会话ID |  |
| 10 | wTotal | unsigned short | 有包分片时，分片总数 |  |
| 11 | wCurSeq | unsigned short | 有包分片时，分片序号 |  |

### 对外端口说明

| 类型 | 端口号 |
| --- | --- |
| socket | 7051 |
| websocket | 7052 |
| HTTP | 7053 |

# 内部接口说明

### 内部模块接口参数说明

| 模块名称 | 请求命令号 | 推送命令号 | 查询端口 | 服务端口 | 错误码 | 请求 | 响应 | 推送 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 前置机 | 1000~9999 |  | 7050 | 7051 | 1~99 | http/socket/websocket+json | http/socket/websocket+json |  |
| 行情接入 | 11000~11499 | 11500~11999 |  |  |  |  |  |  |
| 采集 | 12000~12499 | 12500~12999 |  |  |  |  |  |  |
| 入库 | 13000~13499 | 13500~13999 |  |  |  |  |  |  |
| 行情 | 15000~15499 | 15500~15999 | 7040 | 7041 |  | cmd+seq+md5key+keystring+clienttype+clientid+time+json | cmd+seq+ret+json | cmd+seq+type+count+user/clientid+json |
| STAT | 16000~16499 | 16500~16999 | 7060 | 7061 | 200~299 | cmd+seq+md5key+keystring+clienttype+clientid+time+json | cmd+seq+ret+json | cmd+seq+count+type + value + status + msg + url |
| 资讯 | 17000~17499 | 17500~17999 | 7070 | 7071 | 300~399 | cmd+seq+md5key+keystring+clienttype+clientid+time+json | cmd+seq+ret+json |  |
| PUSH |  |  | 7080 |  |  |  |  |  |
| pay | 19000~19499 | 19500~19999 | 7090 | 7091 | 900~999 | cmd+seq+md5key+keystring+clienttype+clientid+time+json |  |  |
| 反垃圾 | 20000~20499 | 20500~20999 | 8010 | 8011 | 800~899 | cmd+seq+md5key+keystring+clienttype+clientid+time+json |  |  |
| simtrade | 21000~21499 | 21500~21999 | 8020 | 8021 |  |  |  |  |
| lts | 24000~24499 | 24500~24999 | 9300 | 9301 | 1300~1399 | cmd+seq+md5key+keystring+clienttype+clientid+time+json |  |  cmd+seq+type+count+clientid+json |
| xxzh | 25000~25499 | 25500~25999 | 9400 | 9401 | 1400~1499 | cmd+seq+md5key+keystring+clienttype+clientid+time+json |  |  |
| dts | 26000~26499 | 26500~26999 | 9500 | 9501 | 1500~1599 |  |  |  |
| gptg | 22000-22499 | 22500-22999 | 9200 | 9201| 900-999 |  |  |  |
| samek | 28000-28499 | 28500-28999 | 7160 | 7161 | 1200 |  |  |  |
| wb | 29000-29499 | 29500-29999 | 7170 | 7171 | 1300 |  |  |  |
| im | 30000-30499 | 30500-30999 | 9030 | 9031 | 1400 |  |  |  |
### 前置机与STAT接口说明

消息格式: type + value + status + msg + url

| 字段名称 | 字段含义 | 说明 |
| --- | --- | --- |
| type | 类型 | 1表示系统升级标识 2表示clienttype黑名单 3表示clienttype白名单 4表示系统升级白名单用户 |
| value | 值 |  |
| status | 状态 |  0表示新增 1表示删除 |
| msg | 信息 | 相应的提示信息 |
| url | 信息 | 黑名单校验不通过时，msg字段为空则返回url给用户 |
